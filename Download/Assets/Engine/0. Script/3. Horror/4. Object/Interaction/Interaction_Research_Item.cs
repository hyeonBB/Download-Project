using System.Collections;
using System.Collections.Generic;
using UnityEngine;

namespace Horror
{
    public class Interaction_Research_Item : Interaction
    {
        [SerializeField] private NoteItem m_noteItem;
        public NoteItem NoteItem { set => m_noteItem = value; }
        
        private void Start()
        {
            GameObject gameObject = HorrorManager.Instance.Create_WorldHintUI(UIWorldHint.HINTTYPE.HT_RESEARCH, transform.GetChild(0), m_uiOffset);
            m_interactionUI = gameObject.GetComponent<UIWorldHint>();
        }

        private void Update()
        {
            //Update_InteractionUI();
        }

        public override void Click_Interaction()
        {
            if (m_interactionUI.gameObject.activeSelf == false || m_interact == true)
                return;

            UIPopup.TYPE type = UIPopup.TYPE.T_END;
            if (m_noteItem.m_itemType == NoteItem.ITEMTYPE.TYPE_END) // 퀘스트 조합 아이템 (가져가기/ 두고가기)
                type = UIPopup.TYPE.T_QUESTITEM;
            else // 노트, 장비, 소모품 아이템, 단서 (가져가기)
            {
                if (m_noteItem.m_itemType == NoteItem.ITEMTYPE.TYPE_NOTE) // 노트
                    type = UIPopup.TYPE.T_NOTE;
                else if (m_noteItem.m_itemType == NoteItem.ITEMTYPE.TYPE_PIPE || m_noteItem.m_itemType == NoteItem.ITEMTYPE.TYPE_GUN || m_noteItem.m_itemType == NoteItem.ITEMTYPE.TYPE_FLASHLIGHT) // 장비
                    type = UIPopup.TYPE.T_WEAPON;
                else
                {
                    Note playerNote = HorrorManager.Instance.Player.Note; // 노트 보유 여부 검사
                    if (playerNote == null)
                        return;

                    if (m_noteItem.m_itemType == NoteItem.ITEMTYPE.TYPE_BULLET || m_noteItem.m_itemType == NoteItem.ITEMTYPE.TYPE_DRUG || m_noteItem.m_itemType == NoteItem.ITEMTYPE.TYPE_1KEY) // 소모품 아이템
                        type = UIPopup.TYPE.T_EXPENITEM;
                    else // 단서
                        type = UIPopup.TYPE.T_CLUE;
                }
            }

            HorrorManager.Instance.Active_Popup(type, m_noteItem);
            Destroy_Interaction();
        }
    }
}
